---
title: "finalProject"
author: "Eric Appelbaum & Barbara Valischenko"
date: "May 22, 2019"
output: html_document
---

# Cell Phone Data

## Intro

## Libraries

```{r}
library(stringr)
library(tidyverse)
```

## Data

### Raw Data

We are using the dataset [1.4 Million Phone Reviews](https://www.kaggle.com/masaladata/14-million-cell-phone-reviews) from Kaggle. This dataset encompasses over 1.4 million reviews across various brands, models, countries, languages, and websites.

```{r}
review1 <- read.csv("data/phone_user_review_file_1.csv")
review2 <- read.csv("data/phone_user_review_file_2.csv")
review3 <- read.csv("data/phone_user_review_file_3.csv")
review4 <- read.csv("data/phone_user_review_file_4.csv")
review5 <- read.csv("data/phone_user_review_file_5.csv")
review6 <- read.csv("data/phone_user_review_file_6.csv")
```

```{r}
reviews <- rbind.fill(review1, review2, review3, review4, review5, review6)
```

The data is contained within six different CSVs that all have the same format, so they can easily be stitched together into one large data frame with rbind from the dplyr package in tidyverse.

### Data Cleaning

```{r}
reviews$phone_url = substring(reviews$phone_url, 13, str_length(reviews$phone_url)-1)
reviews$date = as.Date(reviews$date, "%m/%d/%Y")

reviews <- reviews %>%
  na.omit()

reviews
```

In order to clean up the data, there are some changes we want to make. First, the phone_url serves as an identifier for the make and model of a phone; however, all phone-url entries start with /cellphone/ and end with /. We remove these to get a cleaned version of phone_url that we will use in the next data wrangling process.

We also need to type convert the date from M/D/Y format into a digital date value.

Lastly, we decide to omit any data that contains NA values. Because we have over 1.4 million reviews that we pull from, we have the luxury of being able to omit all NA entries without hurting the magnitide of our sample size. (1.4m -> 1.3m)

```{r}
reviews_bm <- reviews %>%
  separate(phone_url, c("brand", "model"), sep = "-", extra = "merge")

reviews_bm
```

The most common way people refer to a phone is by it's brand and model name: E.g. Samsung Galaxy S8. These only exist together as part of the phone_url, but in order to do analysis on only a specific brand of phone or a specific model we need to separate them. Fortunately, the phone_url uses a standardized layout: [brand]-[model]. All we have to do is separate phone_url on the first - character.

## EDA

```{r}
reviews_bm %>%
  group_by(brand, model) %>%
  summarize(count = n(), mean_score = mean(score)) %>%
  sort(mean_score)
```


```{r}

note_reviews = reviews %>%
  filter(phone_url=="samsung-galaxy-note-7") %>%
  group_by(date) %>%
  summarize(mean_score=mean(score))
note_reviews

note_reviews %>%
  ggplot(aes(date,mean_score)) +
  geom_point() + geom_smooth(method=lm) + geom_vline(xintercept = as.numeric(as.Date("2016-09-02")), color="red")

```

```{r}
country_reviews = reviews %>%
  filter(!is.na(score)) %>%
  group_by(country) %>%
  summarize(mean_score = mean(score))

country_reviews

country_reviews %>%
  ggplot(aes(country,mean_score)) +
  geom_bar(stat = "identity")
```

## Hypothesis Testing and ML
