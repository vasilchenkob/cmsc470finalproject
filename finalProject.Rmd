---
title: "finalProject"
author: "Eric Appelbaum & Varvara Valischenko"
date: "May 22, 2019"
output: html_document
---

# Cell Phone Data

## Intro

## Libraries

```{r}
library(stringr)
library(tidyverse)
```

## Data

### Raw Data

We are using the dataset [1.4 Million Phone Reviews](https://www.kaggle.com/masaladata/14-million-cell-phone-reviews) from Kaggle. This dataset encompasses over 1.4 million reviews across various brands, models, countries, languages, and websites.

```{r}
review1 <- read.csv("data/phone_user_review_file_1.csv")
review2 <- read.csv("data/phone_user_review_file_2.csv")
review3 <- read.csv("data/phone_user_review_file_3.csv")
review4 <- read.csv("data/phone_user_review_file_4.csv")
review5 <- read.csv("data/phone_user_review_file_5.csv")
review6 <- read.csv("data/phone_user_review_file_6.csv")
```

```{r}
reviews <- rbind.fill(review1, review2, review3, review4, review5, review6)
reviews$phone_url = substring(reviews$phone_url, 13, str_length(reviews$phone_url)-1)
reviews$date = as.Date(reviews$date, "%m/%d/%Y")

reviews
```

### Data Cleaning


```{r}
reviews_bm <- reviews %>%
  na.omit() %>%
  separate(phone_url, c("brand", "model"), sep = "-", extra = "merge")

reviews_bm
```

## EDA

```{r}
reviews_bm %>%
  na.omit() %>%
  group_by(brand, model) %>%
  summarize(count = n(), mean_score = mean(score)) %>%
  sort(mean_score)
```

### Galaxy Note 7
```{r}

note_reviews = reviews %>%
  filter(phone_url=="samsung-galaxy-note-7") %>%
  group_by(date) %>%
  summarize(mean_score=mean(score))
note_reviews

note_reviews %>%
  ggplot(aes(date,mean_score)) +
  geom_point() + geom_smooth(method=lm) + geom_vline(xintercept = as.numeric(as.Date("2016-09-02")), color="red")

```
Knowing about the [unfortunate events](https://www.theverge.com/2016/9/2/12767670/samsung-galaxy-note-7-recall-fire-risk) following the release of the Note 7, we were interested to see what the effect was on the online rating. We mapped the mean score for the phone over time, and plotted the date when the phone was recalled (September 2nd, 2016). To do this, we filtered the dataframe by phone name to only display data about the Note 7, then grouped by date and summarized by the mean score to get the mean score for each day. Then, we chose to display the results with a smoothed line graph to illustrate how the scores trended over time. It can be seen that the scores started to drop shortly before the phone was recalled. 

### Country Optimism
```{r}
country_reviews = reviews %>%
  filter(!is.na(score)) %>%
  group_by(country) %>%
  summarize(mean_score = mean(score))
country_reviews

country_reviews %>%
  ggplot() +
  geom_bar(aes(country,mean_score), stat = "identity") + coord_cartesian(ylim=c(6.0,10.0)) +
  geom_bar(data=subset(country_reviews, mean_score==min(mean_score)), aes(country, mean_score), fill="red", stat="identity") +
  geom_bar(data=subset(country_reviews, mean_score==max(mean_score)), aes(country, mean_score), fill="cyan", stat="identity") 

```
we were interested in seeing the average score by country of the user. From this, we can see that the most optimistic reviewers are from Switzerland (country code ch) and the most pessimistic are from Singapore (country code sg). This was achieved by grouping the data by country and summarized by the mean score. This was then plotted with a bar graph, and the minimum and maximum values were highlighted. 


## Hypothesis Testing and ML
